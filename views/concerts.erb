<!DOCTYPE html>
<html>
<head>
	<meta charset="UTF-8">
	<title>Concerts in Santa Cruz, California</title>
	<link rel="stylesheet" type="text/css" href="css/bootstrap.min.css">
  <link rel="stylesheet" type="text/css" href="css/main.css">
  <link rel="stylesheet" type="text/css" href="css/bootstrap-table.css">
  <link href='//fonts.googleapis.com/css?family=Lobster' rel='stylesheet' type='text/css'>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
  <script src="js/bootstrap.min.js"></script>
  <script src="js/bootstrap-table.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-61984503-1', 'auto');
    ga('send', 'pageview');

  </script>
</head>
<style type='text/css'>@import url('http://getbarometer.s3.amazonaws.com/assets/barometer/css/barometer.css');</style>
<script src='http://getbarometer.s3.amazonaws.com/assets/barometer/javascripts/barometer.js' type='text/javascript'></script>
<script type="text/javascript" charset="utf-8">
  BAROMETER.load('AXcCjEN1kzWM9sBGPTtE7');
</script>
<body>
  <div class="container">
    <div id="toolbar" class="btn-group">
      <h1>Santa Cruz Beat</h1>
    </div>
    <% @concert_days.each do |day, concerts| %>
      <h4><%= Date.parse(day.to_s).strftime("%A %-m/%d") %></h4>
      <div>
      	<table class="concerts-table">
          <thead>
            <tr>
              <th class="concert" data-sortable="true" data-sorter="alphabeticalSorter">Concert</th>
              <th class="venue" data-sortable="true" data-sorter="alphabeticalSorter">Venue</th>
              <th class="description">Description</th>
              <th class="date" data-field="date" data-sortable="true" data-sorter="dateSorter">Time</th>
              <th class="more"></th>
            </tr>
          </thead>
          <tbody>
            <% concerts.each do |concert| %>
              <tr>
                <td class="main title-cell"><%= concert[:title] %></td>
                <td class="venue"><%= concert[:venue] %></td>
                <td class="description"><%= concert.truncated_description %></td>
                <td class="main"><%= concert.local_date_time %></td>
                <td><a class="btn btn-primary" href="<%= concert[:link] %>">More info</a></td>
              </tr>
            <% end %>
          </tbody>
        </table>
      </div>
    <% end %>
  </div>

  <script>
    $(document).ready( function() {
      $('input.form-control').focus();
    });

    function dateSorter(a, b) {
      var dateA = Date.parse(a);
      var dateB = Date.parse(b);
      
      if (dateA < dateB) return 1;
      if (dateA > dateB) return -1;
      return 0;
    }

    function alphabeticalSorter(a, b) {
      var charA = a[0];
      var charB = b[0];

      if (charA < charB) return 1;
      if (charA > charB) return -1;
      return 0;
    }
  </script>
</body>
</html>